// File: wholesaleUtils.js
class WholesaleUtils {
  // Calculate bulk discount
  static calculateBulkPrice(quantity, basePrice, discountTiers) {
    let price = basePrice * quantity;
    for (let tier of discountTiers.sort((a, b) => b.minQuantity - a.minQuantity)) {
      if (quantity >= tier.minQuantity) {
        price = price * (1 - tier.discountPercent / 100);
        break;
      }
    }
    return price;
  }

  // Generate invoice
  static generateInvoice(order, companyInfo) {
    const invoice = {
      invoiceNumber: `INV-${Date.now()}`,
      date: new Date().toLocaleDateString(),
      company: companyInfo,
      customer: order.customer,
      items: order.items,
      subtotal: order.items.reduce((sum, item) => sum + item.price * item.quantity, 0),
      tax: 0,
      total: 0
    };
    
    invoice.tax = invoice.subtotal * 0.18; // 18% GST
    invoice.total = invoice.subtotal + invoice.tax;
    
    return invoice;
  }

  // Stock alert check
  static checkLowStock(products, threshold = 10) {
    return products.filter(product => product.stock <= threshold);
  }

  // Generate barcode data
  static generateBarcodeData(product) {
    return {
      code: product.sku || product.id,
      name: product.name,
      price: product.price,
      stock: product.stock
    };
  }

  // Calculate reorder quantity
  static calculateReorderQuantity(product, daysOfStock = 30, avgDailySale = 5) {
    const daysLeft = product.stock / avgDailySale;
    if (daysLeft < daysOfStock) {
      return Math.ceil((daysOfStock - daysLeft) * avgDailySale);
    }
    return 0;
  }
}

// Export for different module systems
if (typeof module !== 'undefined' && module.exports) {
  module.exports = WholesaleUtils;
} else if (typeof window !== 'undefined') {
  window.WholesaleUtils = WholesaleUtils;
}
